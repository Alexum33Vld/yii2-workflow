<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="raoul2000">
  
  <title>Upgrade from 1.x - yii2-workflow User Guide</title>
  

  <link rel="shortcut icon" href="../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Upgrade from 1.x";
    var mkdocs_page_input_path = "upgrade.md";
    var mkdocs_page_url = "/upgrade/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script>
  <script src="../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> yii2-workflow User Guide</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="..">Introduction</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../overview/">Overview</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Concept</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../concept-overview/">Basics</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../concept-events/">Events</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../concept-source/">Source</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../concept-validation/">Validation</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Specials</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../workflow-creation/">Defining a workflow</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../source-file/">The source file compoent</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Upgrade from 1.x</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#upgrading-from-simpleworkflow-1x">Upgrading From SimpleWorkflow 1.x</a></li>
                
                    <li><a class="toctree-l4" href="#principles">Principles</a></li>
                
                    <li><a class="toctree-l4" href="#definition">Definition</a></li>
                
                    <li><a class="toctree-l4" href="#workflow-tasks">Workflow Tasks</a></li>
                
                    <li><a class="toctree-l4" href="#status-constraints">Status Constraints</a></li>
                
                    <li><a class="toctree-l4" href="#workflow-driven-validation">Workflow Driven Validation</a></li>
                
                    <li><a class="toctree-l4" href="#events">Events</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../special-cookbook/">Cookbook</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../class-ref/">Class Reference</a>
        
    </li>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">yii2-workflow User Guide</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Specials &raquo;</li>
        
      
    
    <li>Upgrade from 1.x</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/raoul2000/yii2-workflow" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="upgrading-from-simpleworkflow-1x">Upgrading From <em>SimpleWorkflow</em> 1.x</h1>
<p>If you have been using the <a href="http://s172418307.onlinehome.fr/project/sandbox/www/index.php?r=simpleWorkflow/page&amp;view=home">previous version of <em>SimpleWorkflow</em></a> together with Yii 1.x and now want to migrate to Yii2, this chapter is for you. We will focus on the main differences between the previous version of <em>SimpleWorkflow</em> (v1.x) and this one (v2.x).</p>
<p>Main improvements in v2.x aimed to clearly separate the workflow definition in terms of status and transition, from the business logic that implements the way a model is going to behave inside a workflow. By doing so, the same workflow can be easily used by models of different types, each one having its own behavior.  </p>
<p>Another goal was to provide maximum flexibility in the way the developer is going to setup its app architecture. For instance the workflow definition can be embedded in any PHP class that implements the appropriate interface (<code>raoul2000\workflow\source\file\IWorkflowDefinitionProvider</code>). Moreover almost all classes can be overloaded and new ones created to implements specific needs not covered by the current version.</p>
<h2 id="principles">Principles</h2>
<p>Not that much to say here, as there is no change in the way the <em>SimpleWorkflowBehavior</em> detects status changes :</p>
<ul>
<li>On one side an ActiveRecord's attribute which can be viewed as the future status.</li>
<li>On the other side, the actual status managed internally by the behavior.</li>
</ul>
<p>A transition is a directed link between to statuses : the <em>start</em> and the <em>end</em> status.  </p>
<h2 id="definition">Definition</h2>
<p>The workflow definition required by the [[raoul2000\workflow\source\file\WorkflowFileSource|WorkflowFileSource]] component differs from previous version :</p>
<ul>
<li>key <code>initial</code> is replaced by <code>initialStatusId</code></li>
<li>key <code>node</code> is replaced by <code>status</code></li>
<li>status ids are stored as keys of the <em>status</em> array (and not as value of the <code>id</code> key anymore)</li>
</ul>
<p>For more information please refer to <a href="../source-file/">Workflow File Source Component</a> documentation.</p>
<h2 id="workflow-tasks">Workflow Tasks</h2>
<h3 id="declaration">Declaration</h3>
<p>Workflow Tasks are not declared anymore in the workflow definition itself. This could create a dependency between the workflow and the model, lie for instance when the workflow tasks was using <em>$this</em>.</p>
<h3 id="implementation">Implementation</h3>
<p>Workflow task used to be a piece of PHP code associated with a workflow transition and evaluated when this transition was performed. With this new version, <strong>Workflow Tasks should be implemented as event handler attached to a <em>after</em> event type</strong>.</p>
<p>Please refer to the <a href="../concept-events/">Workflow Event</a> documentation for more.</p>
<h2 id="status-constraints">Status Constraints</h2>
<h3 id="declaration_1">Declaration</h3>
<p>Status Constraints are not declared anymore in the workflow definition itself, for the same reason as above.</p>
<h3 id="implementation_1">Implementation</h3>
<p>Status Constraints used to be a piece of PHP code associated with a status and evaluated as a logical expression <em>before</em> a model enters into this status. If the evaluation returned TRUE, the model can access the status, otherwise the transition is blocked.</p>
<p>The same principles still applies but in v2.x <strong>status constraints should be implemented as event handler attached to a <em>before</em> event type.</strong></p>
<p>Please refer to the <a href="../concept-events/">Workflow Event</a> documentation for more.</p>
<h2 id="workflow-driven-validation">Workflow Driven Validation</h2>
<p>It is still possible to validate models attributes based on the transition that is done by the model. The principle remains the same : Workflow driven validation is based on dynamic scenario names and their associated validation rules declared in the model.</p>
<p>Please refer to the <a href="../concept-validation/">Workflow Driven Attribute Validation</a> documentation for more.</p>
<h2 id="events">Events</h2>
<p>There are no major changes in the way workflow events are managed although the event model has been enhanced to provide more control through event handlers.</p>
<p>Please refer to the <a href="../concept-events/">Workflow Event</a> documentation for more.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../special-cookbook/" class="btn btn-neutral float-right" title="Cookbook">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../source-file/" class="btn btn-neutral" title="The source file compoent"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/raoul2000/yii2-workflow" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../source-file/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../special-cookbook/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
